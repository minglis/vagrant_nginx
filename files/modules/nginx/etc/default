server {
  server_name         localhost;
  listen              443 ssl;
  ssl                 on;
  
  error_log /var/log/nginx/error.log debug;

  ssl_certificate     /etc/nginx/server.crt;
  ssl_certificate_key /etc/nginx/server.key;
  ssl_client_certificate /etc/nginx/ca.crt;
  ssl_verify_client on;

  location / {
    root                /var/www;
    index               index.html;
    add_header  DN      $ssl_client_s_dn;
  }
  
  location /gateway {
      proxy_pass http://192.168.1.64:8080/gateway;
      proxy_set_header  DN      $ssl_client_s_dn;
      proxy_set_header  X-Real-IP  $remote_addr;
  }
}